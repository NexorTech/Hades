from google.adk.agents import Agent
import os
from .Tools.xssTools import checkXSSVul , ensure_query_param_url
import requests

instructionText =''

script_dir = os.path.dirname(os.path.abspath(__file__))

instruction_path = os.path.join(script_dir, 'instruction.txt')

with open(instruction_path, 'r') as f:
    instructionText = f.read()

def executeCommand(commands:str)-> dict:
    CLI_URL = 'http://localhost:3000/execute'
    response = requests.post(CLI_URL , data = commands)
    return{
        "result" : response
    }


xssAgent = Agent(
model = 'gemini-2.0-flash',
    name="xssAgent",
    description="An XSS testing agent who can test whether there is a XSS vulnerability or not and if yes then based on the request it can generate a command for the cli for using the xsstrike tool",
    instruction=instructionText,
    tools=[
        ensure_query_param_url,
        checkXSSVul,
        executeCommand
    ]
)

root_agent = xssAgent







